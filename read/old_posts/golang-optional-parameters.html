<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Golang 【伪】可选参数（Optional Parameters） - 徐天乐 :: 个人博客</title>
    <link rel="stylesheet" href="/mdui/css/mdui.min.css" />
    <link rel="stylesheet" href="/highlight.js/style.min.css" />
    <script src="/mdui/js/mdui.min.js"></script>
    <script>
        function jump(url) {
            window.location.href = url;
        }

        function autodetect() {
            if (!window.matchMedia('(prefers-color-scheme: dark)').matches) {
                mdui.JQ("body").removeClass("mdui-theme-layout-dark");
            }
        }

        mdui.JQ(document).ready(function() {
            autodetect();
        });
    </script>
    <style>
        body,
        html {
            height: 100%;
        }

        .mdui-theme-layout-dark .mdui-typo code {
            color: #eeeeee !important;
        }
    </style>
</head>

<body class="mdui-appbar-with-toolbar mdui-theme-layout-dark mdui-theme-primary-blue mdui-drawer-body-left" style="height: 100%;">
    <header>
        <div class="mdui-appbar mdui-appbar-fixed">
            <div class="mdui-toolbar mdui-color-theme-900">
                <a href="javascript:;" mdui-drawer="{target: '#drawer-main'}" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon material-icons">menu</i></a>
                <a href="/" class="mdui-typo-headline mdui-ripple">徐天乐 :: 个人博客</a>
                <a href="javascript:;" class="mdui-typo-title mdui-ripple">Golang 【伪】可选参数（Optional Parameters）</a>
                <div class="mdui-toolbar-spacer"></div>
                <a href="/" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon material-icons">home</i></a>
                <a href="https://www.xtlsoft.top/zh-cn" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon material-icons">account_circle</i></a>
            </div>
        </div>
    </header>
    <div class="mdui-drawer" id="drawer-main">
        <ul class="mdui-list mdui-ripple">
                                        <li class="mdui-list-item mdui-ripple">
                    <i class="mdui-list-item-icon mdui-icon material-icons">home</i>
                    <div onclick="jump('/');" class="mdui-list-item-content">首页</div>
                </li>
                            <li class="mdui-list-item mdui-ripple">
                    <i class="mdui-list-item-icon mdui-icon material-icons">list</i>
                    <div onclick="jump('/categories.html');" class="mdui-list-item-content">分类</div>
                </li>
                            <li class="mdui-list-item mdui-ripple">
                    <i class="mdui-list-item-icon mdui-icon material-icons">archive</i>
                    <div onclick="jump('/archive.html');" class="mdui-list-item-content">归档</div>
                </li>
                            <li class="mdui-list-item mdui-ripple">
                    <i class="mdui-list-item-icon mdui-icon material-icons">link</i>
                    <div onclick="jump('/link.html');" class="mdui-list-item-content">友情链接</div>
                </li>
                            <li class="mdui-list-item mdui-ripple">
                    <i class="mdui-list-item-icon mdui-icon material-icons">account_circle</i>
                    <div onclick="jump('https://www.xtlsoft.top/zh-cn');" class="mdui-list-item-content">个人主页</div>
                </li>
                            <li class="mdui-list-item mdui-ripple">
                    <i class="mdui-list-item-icon mdui-icon material-icons">mail</i>
                    <div onclick="jump('mailto:xtl@xtlsoft.top');" class="mdui-list-item-content">Mail</div>
                </li>
                    </ul>
    </div>
    <div id="main" style="margin: 0px 15px; min-height: 90%;"><div class="mdui-typo">
    <h1>
        Golang 【伪】可选参数（Optional Parameters）        <br />
        <small>
            作者: xtlsoft &nbsp; &nbsp;
            时间: 2018-06-30 13:28:16 &nbsp; &nbsp;
            分类: 旧稿        </small>
    </h1>
    <div>
        <h2>由来</h2>
<blockquote>
<p>TL;DR 可以直接看最下面“我的解决方案“。</p>
</blockquote>
<p>前几天，在 <a href="https://www.github.com/gosrc">@gosrc</a> （果子）的 Golang 群里，谈到可选参数的事情，这里我就来详细说明一下。</p>
<h2>官方的支持</h2>
<h3>错误写法</h3>
<p>Golang 官方并没有对可选参数提供任何支持，所以目前我们大家在其他语言中习惯的这种写法是错误的：</p>
<pre><code class="language-go">func TestFuncWithOptionalParameters(arg1 string, arg2 int = true) {
    // Do something...
}
</code></pre>
<p>嗯，100% 无法编译。
另外，这种写法也是错误的：</p>
<pre><code class="language-go">func TestFuncWithAnotherOptionalParameter(arg1 string, [arg2 int]) {
    // Do something...
}
</code></pre>
<p>嗯，仍然无法编译。</p>
<h3>官方的说明</h3>
<p>官方的文章中表示，可选参数不是十分有用，所以今后都不会支持。</p>
<h2>常见的解决办法</h2>
<h3>不使用可选参数</h3>
<p>这个我想我就不用多说了。
例如使用 <code>nil</code> ，最著名的算是 <code>net/http</code> 中 <code>ListenAndServe</code> 方法了。</p>
<pre><code class="language-go">import &quot;net/http&quot;
func Serve() {
    // &quot;:8080&quot; 是端口号，而 nil 是 Handler 参数，为 nil 代表使用 http.Handle() 或 http.HandleFunc() 注册过的 Handler。
    http.ListenAndServe(&quot;:8080&quot;, nil)
}
</code></pre>
<h3>常用解决方案</h3>
<blockquote>
<p>该方案常见于各大开源项目，但是不能实际上很好地解决问题，因为调用时依然不能像 Javascript，PHP，Python 这类语言一样直接忽略。</p>
</blockquote>
<p>定义一个 Struct ，叫 XXXArguments 或 XXXParameters 之类的。
然后里面写明白参数列表。</p>
<pre><code class="language-go">type ExampleFuncParameters struct {
    Arg1 string
    Arg2 bool `optional` // `optional` 仅是为了演示时方便识别，实际上没用。
}
</code></pre>
<p>函数可以这么写：</p>
<pre><code class="language-go">func ExampleFunc(args *ExampleFuncParameters) {
    if !args.Arg2 {
        args.Arg2 = false
    }
    // Do something...
}
</code></pre>
<p>但是调用比较麻烦：</p>
<pre><code class="language-go">ExampleFunc(&amp;ExampleFuncParameters{
    Arg1: &quot;Example&quot;,
    Arg2: true,
})
</code></pre>
<h2>我的解决方案</h2>
<p>这是我某次写项目时想到的。
主要用了 Golang 的不定参数用法，比较完美。</p>
<p>依然直接上例子：</p>
<pre><code class="language-go">func MyMagicFunc(arg1 string, arg2a ...int) {
    if len(arg2a) == 1 {
        arg2 := arg2a[0]
    }else{
        arg2 := 0
    }
    // Do something
}
</code></pre>
<p>这样不用定义 Struct ，且调用方便：</p>
<pre><code class="language-go">MyMagicFunc(&quot;aaa&quot;) // OK
MyMagicFunc(&quot;bbb&quot;, 2) // Also OK
</code></pre>
<p>就到这。</p>
<h2>版权申明</h2>
<p>顺便说一声，本博客除标明转载的部分，均为原创。若转载一般也是直接外链，除非他站无法正常访问。</p>
<p>转载可以，不过请写明：</p>
<blockquote>
<p>Written By Tianle Xu <a href="mailto:xtl@xtlsoft.top">xtl@xtlsoft.top</a> <a href="https://blog.xtlsoft.top/">https://blog.xtlsoft.top/</a></p>
</blockquote>
    </div>
</div>
<link rel="stylesheet" href="/comment/comment.css" />
<script src="/comment/md5.js" type="text/javascript"></script>
<script src="/comment/comment.js" type="text/javascript"></script>
<div class="mdui-typo">
    <br />
    <h1>评论</h1>
</div>
<div id="comment_base"></div>
<script>
    window.commentPresenter.init("#comment_base");
</script><script>
    mdui.JQ("table").addClass("mdui-table mdui-table-hoverable");
</script>
</div>
<div class="mdui-color-theme" style="height: 75px; margin: 0;">
    <div class="mdui-container">
        <div class="mdui-typo" style="height: 75px; margin: 0;">
            <p align="center" style="height: 75px; line-height: 75px; margin: 0;">
                &copy; xtlsoft 2016-2022            </p>
        </div>
    </div>    </div>
        </body>
    <script type="text/javascript" src="/highlight.js/highlight.min.js"></script>
    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
</html>