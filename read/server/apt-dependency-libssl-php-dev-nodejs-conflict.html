<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Ubuntu 18.04 中 php-dev 与 nodejs 冲突（libssl）解决方式 - 徐天乐 :: 技术博客</title>
    <link rel="stylesheet" href="/mdui/css/mdui.min.css" />
    <link rel="stylesheet" href="/highlight.js/style.min.css" />
    <script src="/mdui/js/mdui.min.js"></script>
    <script>
        function jump(url) {
            window.location.href = url;
        }
        if (xx_prev) xx_prev();
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            mdui.JQ("body").addClass("mdui-theme-layout-dark");
        }
    </script>
    <style>
        body,
        html {
            height: 100%;
        }

        .mdui-theme-layout-dark .mdui-typo code {
            color: #eeeeee !important;
        }
    </style>
</head>

<body class="mdui-appbar-with-toolbar mdui-theme-layout-auto mdui-theme-primary-blue mdui-drawer-body-left" style="height: 100%;">
    <header>
        <div class="mdui-appbar mdui-appbar-fixed">
            <div class="mdui-toolbar mdui-color-theme-900">
                <a href="javascript:;" mdui-drawer="{target: '#drawer-main'}" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon material-icons">menu</i></a>
                <a href="/" class="mdui-typo-headline mdui-ripple">徐天乐 :: 技术博客</a>
                <a href="javascript:;" class="mdui-typo-title mdui-ripple">Ubuntu 18.04 中 php-dev 与 nodejs 冲突（libssl）解决方式</a>
                <div class="mdui-toolbar-spacer"></div>
                <a href="/" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon material-icons">home</i></a>
                <a href="https://www.xtlsoft.top/zh-cn" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon material-icons">account_circle</i></a>
            </div>
        </div>
    </header>
    <div class="mdui-drawer" id="drawer-main">
        <ul class="mdui-list mdui-ripple">
                                        <li class="mdui-list-item mdui-ripple">
                    <i class="mdui-list-item-icon mdui-icon material-icons">home</i>
                    <div onclick="jump('/');" class="mdui-list-item-content">首页</div>
                </li>
                            <li class="mdui-list-item mdui-ripple">
                    <i class="mdui-list-item-icon mdui-icon material-icons">list</i>
                    <div onclick="jump('/categories.html');" class="mdui-list-item-content">分类</div>
                </li>
                            <li class="mdui-list-item mdui-ripple">
                    <i class="mdui-list-item-icon mdui-icon material-icons">archive</i>
                    <div onclick="jump('/archive.html');" class="mdui-list-item-content">归档</div>
                </li>
                            <li class="mdui-list-item mdui-ripple">
                    <i class="mdui-list-item-icon mdui-icon material-icons">link</i>
                    <div onclick="jump('/link.html');" class="mdui-list-item-content">友情链接</div>
                </li>
                            <li class="mdui-list-item mdui-ripple">
                    <i class="mdui-list-item-icon mdui-icon material-icons">account_circle</i>
                    <div onclick="jump('https://www.xtlsoft.top/zh-cn');" class="mdui-list-item-content">个人主页</div>
                </li>
                            <li class="mdui-list-item mdui-ripple">
                    <i class="mdui-list-item-icon mdui-icon material-icons">mail</i>
                    <div onclick="jump('mailto:xtl@xtlsoft.top');" class="mdui-list-item-content">Mail</div>
                </li>
                    </ul>
    </div>
    <div id="main" style="margin: 0px 15px; min-height: 90%;"><div class="mdui-typo">
    <h1>
        Ubuntu 18.04 中 php-dev 与 nodejs 冲突（libssl）解决方式        <br />
        <small>
            作者: xtlsoft &nbsp; &nbsp;
            时间: 2019-07-24 15:01:02 &nbsp; &nbsp;
            分类: 服务运维        </small>
    </h1>
    <div>
        <h2>由来</h2>
<p>在 Windows Subsystem Linux (WSL) 上执行 PHP 拓展开发工作。例行安装 <code>php-dev</code> 包。</p>
<p>提示我将拆卸 <code>npm</code>, <code>nodejs-dev</code>, <code>nodejs-gyp</code>, <code>nodejs</code>？</p>
<h2>检查</h2>
<p>翻查各种 apt 的输出，发现是 <code>php-dev</code> 依赖 <code>libssl-dev</code>，而 <code>nodejs-dev</code> 依赖 <code>libssl1.0-dev</code>，而这两个包实际上内容差不多（甚至完全一样），然后 Conflict 了。</p>
<p>怎么办呢？</p>
<p>正当我准备重新打 fake 包 <code>libssl-dev</code> 来解决这个问题的时候，我搜索到了一些东西。</p>
<h2>搜索</h2>
<p>发现并不是我第一次遇到这样的问题。我在 <code>deepin</code> 的论坛中查找到了类似问题。（好像是 <code>deb</code> 系的都存在过这样的问题？）</p>
<p>附上链接：<a href="https://bbs.deepin.org/forum.php?mod=viewthread&amp;tid=145483">https://bbs.deepin.org/forum.php?mod=viewthread&amp;tid=145483</a> （挺老了）</p>
<p><a href="https://www.github.com/jingle">@jingle</a> 叫重新 build <code>wiznote</code> 包（相当于此处的 <code>nodejs-dev</code> 包），但是我会选择打一个空包 <code>libssl-dev</code> 给 <code>php-dev</code> 吃。（之前也有用过这样的伎俩，详见装<code>ajenti</code>的那篇很老很老的文章）</p>
<p>好，接下来一位同学提示直接修改 <code>/var/lib/dpkg/status</code>。</p>
<h2>解决</h2>
<p>没啥悬念</p>
<pre><code class="language-sh">sudo vim /var/lib/dpkg/status
# ------&gt; (vim console) /nodejs-dev/
#   ----&gt; (Press 'N' key)
#     --&gt; (jumped to  `nodejs-dev` segment)
#       &gt; (delete `libssl1.0-dev (&gt;=xxxxx)` dependency (xxxxx can be the version))
sudo apt install -y php-dev
</code></pre>
<h2>总结</h2>
<p>希望软件源快更新 <code>php-dev</code> 的 <code>dependency</code>。</p>
    </div>
</div>
<link rel="stylesheet" href="/comment/comment.css" />
<script src="/comment/md5.js" type="text/javascript"></script>
<script src="/comment/comment.js" type="text/javascript"></script>
<div class="mdui-typo">
    <br />
    <h1>评论</h1>
</div>
<div id="comment_base"></div>
<script>
    window.commentPresenter.init("#comment_base");
</script><script>
    mdui.JQ("table").addClass("mdui-table mdui-table-hoverable");
</script>
</div>
<div class="mdui-color-theme" style="height: 75px; margin: 0;">
    <div class="mdui-container">
        <div class="mdui-typo" style="height: 75px; margin: 0;">
            <p align="center" style="height: 75px; line-height: 75px; margin: 0;">
                &copy; xtlsoft 2016-2020            </p>
        </div>
    </div>    </div>
        </body>
    <script type="text/javascript" src="/highlight.js/highlight.min.js"></script>
    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
</html>